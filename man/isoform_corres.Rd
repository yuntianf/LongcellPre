% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/splice_site_correct.R
\name{isoform_corres}
\alias{isoform_corres}
\title{isoform_corres
Infer isoform correspondence from a coexistence count matrix}
\usage{
isoform_corres(coexist_matrix)
}
\arguments{
\item{coexist_matrix}{A square numeric matrix of coexistence counts with
matching row and column names (isoform identifiers). Diagonal entries
represent self-coexistence.}
}
\value{
A two-column \code{data.frame} with row names set to \code{from}:
  \describe{
    \item{\code{from}}{Row isoform identifier.}
    \item{\code{to}}{Mapped target isoform identifier (or \code{NA} if no evidence).}
  }
}
\description{
Builds a row-wise mapping from each isoform (row) to its most likely
corresponding isoform(s) (column) using a square coexistence matrix of
pairwise counts, with optional dispute resolution to drop unreliable
target columns before finalizing the map.
}
\details{
Workflow:
\enumerate{
  \item Identify a set of \emph{trustworthy targets}: keep columns whose
        diagonal count is strictly greater than twice their total off-diagonal
        mass, i.e. \eqn{M_{ii} > 2 \sum_{j \neq i} M_{ji}}.
  \item Initial mapping: for each row, pick the target column among the
        trustworthy set with the largest count (ties broken by first match);
        rows with all-zero counts map to \code{NA}.
  \item Dispute resolution: if any row maps to a different column than itself,
        call \code{disagree_sites(from, to)} and, for columns where
        \code{wrong > correct} and \code{disagree * 3 > wrong}, drop those
        columns from the trustworthy set and recompute the mapping restricted
        to the remaining targets.
}
}
