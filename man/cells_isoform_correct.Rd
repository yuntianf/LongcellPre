% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/splice_site_correct.R
\name{cells_isoform_correct}
\alias{cells_isoform_correct}
\title{cells_isoform_correct
Correct and assign isoforms per (cell, cluster)}
\usage{
cells_isoform_correct(cells, cluster, gene_isoform, polyA)
}
\arguments{
\item{cells}{A vector of cell/barcode identifiers.}

\item{cluster}{A vector of cluster labels aligned with \code{cells}.}

\item{gene_isoform}{A matrix/data.frame giving isoform structure. If it has
more than two columns, internal splice-site columns are used for isoform
recovery.}

\item{polyA}{A numeric (or logical) vector aligned with \code{cells} used to
track poly(A) evidence.}
}
\value{
A \code{data.frame} of corrected isoform calls per (cell, cluster),
  including:
  \describe{
    \item{\code{cell}}{Cell identifier.}
    \item{\code{cluster}}{Cluster label.}
    \item{\code{mid}}{Consensus mid (or \code{"null"} if unavailable).}
    \item{\code{size, polyA}}{Group size and mean poly(A) support.}
    \item{\code{isoform}}{Recovered isoform identifier.}
  }
}
\description{
Generates corrected isoform calls for each \code{(cell, cluster)} by combining
mid-level correction (when splice-site information is available) or by
summarizing intervals (when no mid information exists), followed by recovery
of isoform identifiers from start/end positions and splice sites.
}
\details{
Workflow:
\enumerate{
  \item If \code{gene_isoform} has >2 columns (implying splice-site structure):
        \itemize{
          \item Extract splice-site names from column 2 to (n-1).
          \item Run \code{cells_mid_correct()} to obtain consensus mids and corrected
                per-(cell, cluster) records.
          \item For each row, recover isoform identity using
                \code{site_recover(start, end, mid, splice_sites)}.
        }
  \item Otherwise:
        \itemize{
          \item Summarize per-group intervals via \code{cells_nomid_correct()}.
          \item Recover isoforms using \code{site_recover(start, end)}.
          \item Assign a placeholder mid of \code{"null"}.
        }
  \item Drop empty results and remove \code{start, end} columns after recovery.
}
}
