% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/splice_site_correct.R
\name{cells_mid_correct}
\alias{cells_mid_correct}
\title{cells_mid_correct
Correct per-cell isoform assignments using mid-level consensus and coexistence}
\usage{
cells_mid_correct(cells, cluster, gene_isoform, polyA)
}
\arguments{
\item{cells}{A vector of cell/barcode identifiers.}

\item{cluster}{A vector of cluster labels aligned with \code{cells}.}

\item{gene_isoform}{Isoform annotation aligned with \code{cells} (format as
required by \code{mid_correct_input()}).}

\item{polyA}{A numeric (or logical) vector aligned with \code{cells} giving
poly(A) evidence to carry through to the output.}
}
\value{
A \code{data.frame} of per-(cell, cluster) corrected isoform data
  after applying the consensus/coexistence-derived correspondence map.
}
\description{
Constructs per-(cell, cluster) inputs, computes consensus mids and their
coexistence using \code{mid_coexist_fast()}, derives an isoform correspondence
map from the coexistence matrix, and applies isoform-level corrections.
}
\details{
Steps:
\enumerate{
  \item Build input with \code{mid_correct_input(cells, cluster, gene_isoform)}.
  \item Run \code{mid_coexist_fast()} to obtain a consensus mid per group and
        a long table of mid-to-mid coexistence counts.
  \item If multiple mid pairs exist, convert to a square matrix with
        \code{long2square(..., symmetric = FALSE)}, infer the correspondence
        via \code{isoform_corres()}.
  \item Join consensus to the input, attach \code{polyA}, and apply
        \code{isoform_correct(data, corres)} to produce corrected isoform calls.
}
}
